<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deadboard</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
</head>

<body data-bs-theme="dark">

    <header class="p-3 bg-success text-white text-center">
        <div class="profile-picture">
            <img src="https://www.gravatar.com/avatar/9356459e6204f54bea0afb1292a0651b?s=150" alt="User" class="rounded-circle my-3">
        </div>
        <h1>Juan Pablo Ruiz</h1>
        <h2>Mi mierda personal</h2>
    </header>

    <main class="container my-3">

        


        <h3>Mi vida se est치 terminando...</h3>

        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <hr>

        <div id="countdown"></div>

    </main>

    <footer>
        <p id="visit-count">Vistas: </p>
      </footer>

      <script>
    async function updateVisitCount() {
      const user = 'juanpabloruiz'; // Tu nombre de usuario de GitHub
      const repo = 'Deadboard'; // El nombre de tu repositorio
      const path = 'counter.txt'; // La ruta al archivo dentro del repositorio
      const token = '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'; // Tu token de acceso personal de GitHub

      // Obtener el contenido del archivo counter.txt en el repositorio
      const response = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/${path}`, {
        headers: {
          Authorization: `token ${token}`,
        },
      });
      if (!response.ok) {
        console.error('Error al obtener el archivo:', response.statusText);
        return;
      }
      const data = await response.json();
      const content = atob(data.content);
      let count = parseInt(content);

      // Incrementar el contador
      count++;

      // Mostrar el contador en la p치gina
      document.getElementById('visit-count').innerText = `Visitas: ${count}`;

      // Codificar el nuevo contador en base64
      const encodedContent = btoa(count.toString());

      // Escribir el nuevo contador en el archivo counter.txt en el repositorio
      await fetch(`https://api.github.com/repos/${user}/${repo}/contents/${path}`, {
        method: 'PUT',
        headers: {
          Authorization: `token ${token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          message: 'Actualizar contador de visitas',
          content: encodedContent,
          sha: data.sha,
        }),
      });
    }

    // Llamar a la funci칩n updateVisitCount() al cargar la p치gina
    window.onload = function() {
      updateVisitCount();
    };
  </script>

    <script src="js/bootstrap.min.js"></script>
    <script src="script.js"></script>

</body>

</html>